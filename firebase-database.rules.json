{
  "rules": {
    "chats": {
      ".read": true,
      ".write": true,
      "$chatId": {
        ".read": true,
        ".write": true,
        "info": {
          ".read": true,
          ".write": true,
          "username": {
            ".validate": "newData.isString() && newData.val().length > 0 && newData.val().length <= 100"
          },
          "email": {
            ".validate": "newData.isString()"
          },
          "userId": {
            ".validate": "newData.isString()"
          },
          "createdAt": {
            ".validate": "newData.isNumber()"
          },
          "lastMessageTime": {
            ".validate": "newData.isNumber()"
          },
          "lastMessage": {
            ".validate": "newData.isString()"
          },
          "unreadCount": {
            ".validate": "newData.isNumber()"
          },
          "status": {
            ".validate": "newData.isString()"
          }
        },
        "messages": {
          ".read": true,
          ".write": true,
          "$messageId": {
            ".read": true,
            ".write": true,
            "text": {
              ".validate": "newData.isString() && newData.val().length >= 0 && newData.val().length <= 5000"
            },
            "username": {
              ".validate": "newData.isString() && newData.val().length > 0 && newData.val().length <= 100"
            },
            "type": {
              ".validate": "newData.isString() && (newData.val() === 'user' || newData.val() === 'admin' || newData.val() === 'system')"
            },
            "timestamp": {
              ".validate": "newData.isNumber()"
            },
            "id": {
              ".validate": "newData.isString()"
            }
          }
        },
        "readBy": {
          ".read": true,
          ".write": true,
          "$userId": {
            ".validate": "newData.isNumber()"
          }
        }
      }
    },
    "userChats": {
      ".read": true,
      ".write": true,
      "$username": {
        ".read": true,
        ".write": true,
        "$chatId": {
          ".read": true,
          ".write": true,
          "chatId": {
            ".validate": "newData.isString()"
          },
          "title": {
            ".validate": "newData.isString() && newData.val().length > 0 && newData.val().length <= 200"
          },
          "createdAt": {
            ".validate": "newData.isNumber()"
          },
          "lastActivity": {
            ".validate": "newData.isNumber()"
          },
          "status": {
            ".validate": "newData.isString() && (newData.val() === 'active' || newData.val() === 'closed' || newData.val() === 'archived')"
          }
        }
      }
    },
    "globalChat": {
      ".read": true,
      ".write": true,
      "$messageId": {
        ".read": true,
        ".write": true,
        "text": {
          ".validate": "newData.isString() && newData.val().length > 0 && newData.val().length <= 5000"
        },
        "username": {
          ".validate": "newData.isString() && newData.val().length > 0"
        },
        "type": {
          ".validate": "newData.isString() && (newData.val() === 'user' || newData.val() === 'admin' || newData.val() === 'system')"
        },
        "timestamp": {
          ".validate": "newData.isNumber()"
        }
      }
    },
    "submissions": {
      ".read": true,
      ".write": true,
      "$submissionId": {
        ".read": true,
        ".write": true
      }
    },
    "activeUsers": {
      ".read": true,
      ".write": true,
      "$sessionId": {
        ".read": true,
        ".write": true
      }
    },
    "adminChats": {
      ".read": true,
      ".write": true,
      "$chatId": {
        ".read": true,
        ".write": true
      }
    }
  }
}

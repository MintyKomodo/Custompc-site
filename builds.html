<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Builds – CustomPC.tech</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
  <style>
    /* Layout */
    .controls { display:flex; flex-wrap:wrap; gap:10px; justify-content:center; margin:10px 0 20px; }
    .controls .btn { min-width:120px; }
    .filters { display:flex; flex-wrap:wrap; gap:8px; justify-content:center; margin:0 0 10px; }
    .filters select { padding:8px 10px; border-radius:10px; border:1px solid rgba(255,255,255,.1); background:rgba(0,0,0,.28); color:#e9eefc; }

    /* Featured section */
    .featured-grid { display:grid; grid-template-columns: 2fr 1fr; gap:12px; margin-bottom:14px; }
    @media (max-width:980px){ .featured-grid { grid-template-columns:1fr; } }
    .featured-card {
      position:relative; border:1px solid rgba(255,255,255,.08); border-radius:14px; overflow:hidden; background:rgba(0,0,0,.28);
      display:flex; min-height:260px;
    }
    .featured-card img { width:50%; object-fit:cover; }
    .featured-body { padding:14px; display:flex; flex-direction:column; gap:8px; }
    .featured-card .tag { opacity:.8; }
    .featured-cta { margin-top:auto; display:flex; gap:8px; }

    /* Grid cards */
    .grid { display:grid; grid-template-columns:repeat(3,1fr); gap:12px; }
    @media (max-width:980px){ .grid { grid-template-columns:repeat(2,1fr); } }
    @media (max-width:640px){ .grid { grid-template-columns:1fr; } }

    .card-pc { position:relative; border:1px solid rgba(255,255,255,.08); border-radius:12px; overflow:hidden; background:rgba(0,0,0,.28); transition: transform .12s ease, box-shadow .2s ease; }
    .card-pc:hover { transform: translateY(-2px); box-shadow: 0 12px 30px rgba(0,0,0,.35); }
    .card-pc img { display:block; width:100%; height:180px; object-fit:cover; cursor:pointer; }
    .card-pc .content { padding:12px; }
    .tag { font-size:12px; opacity:.75; }
    .badge { position:absolute; top:8px; left:8px; background:rgba(20,160,255,.2); border:1px solid rgba(20,160,255,.35); padding:4px 8px; border-radius:999px; font-size:12px; }

    /* Hover quick specs */
    .quick {
      position:absolute; inset:auto 0 0 0; background:linear-gradient(180deg, rgba(0,0,0,0), rgba(0,0,0,.7));
      color:#e9eefc; padding:10px 12px; opacity:0; transition: opacity .15s ease;
    }
    .card-pc:hover .quick { opacity:1; }
    .quick small { opacity:.85; }

    /* Modal */
    .modal { position:fixed; inset:0; background:rgba(0,0,0,.6); display:none; align-items:center; justify-content:center; padding:16px; z-index:90; }
    .modal.open { display:flex; }
    .modal-card { max-width:880px; width:100%; background:#0d1016; border:1px solid rgba(255,255,255,.08); border-radius:14px; overflow:hidden; box-shadow:0 18px 60px rgba(0,0,0,.45); }
    .modal-media { width:100%; height:320px; background:#000; object-fit:cover; display:block; }
    .modal-body { padding:16px; }
    .specs { display:grid; grid-template-columns:1fr 1fr; gap:8px; }
    .spec { border:1px solid rgba(255,255,255,.08); border-radius:10px; padding:8px; background:rgba(255,255,255,.02); }
    @media (max-width:760px){ .specs { grid-template-columns:1fr; } }
    .fps { margin-top:10px; border:1px solid rgba(255,255,255,.08); border-radius:10px; overflow:hidden; }
    .fps table { width:100%; border-collapse:collapse; }
    .fps th, .fps td { padding:8px 10px; border-bottom:1px solid rgba(255,255,255,.06); text-align:left; font-size:14px; }
    .fps tr:last-child td { border-bottom:none; }
  </style>
</head>
<body>
  <nav>
    <a href="index.html">Contact</a>
    <a href="custom.html">Custom PC</a>
    <a href="about.html">About</a>
    <a href="builds.html">Builds</a>
    <a href="cart.html">Cart</a>
    <span id="nav-user" class="hidden"></span>
    <a id="nav-login" href="login.html">Log In</a>
    <a id="nav-signup" href="signup.html">Sign Up</a>
    <a id="nav-logout" class="hidden" href="javascript:void(0)">Log Out</a>
  </nav>

  <div class="container">
    <h1>Custom PC Builds</h1>

    <!-- AMD / Intel toggle -->
    <div class="controls">
      <button id="btn-amd" class="btn" onclick="setBrand('amd')">AMD Builds</button>
      <button id="btn-intel" class="btn" onclick="setBrand('intel')">Intel Builds</button>
    </div>

    <!-- Filters + Sort -->
    <div class="filters">
      <select id="filterUse">
        <option value="all" selected>All uses</option>
        <option value="Gaming">Gaming</option>
        <option value="Creator">Creator</option>
        <option value="Esports">Esports</option>
        <option value="Value">Best Value</option>
      </select>
      <select id="filterPrice">
        <option value="all" selected>All prices</option>
        <option value="0-1000">Under $1,000</option>
        <option value="1000-2000">$1,000–$2,000</option>
        <option value="2000-3500">$2,000–$3,500</option>
        <option value="3500-999999">$3,500+</option>
      </select>
      <select id="sort">
        <option value="popular" selected>Sort: Popular</option>
        <option value="price-asc">Price: Low to High</option>
        <option value="price-desc">Price: High to Low</option>
        <option value="newest">Newest</option>
      </select>
    </div>

    <!-- Featured -->
    <div id="featured" class="featured-grid"></div>

    <!-- Main grid -->
    <div id="grid" class="grid"></div>

    <!-- Bottom CTA -->
    <div class="cta-bottom" style="padding:16px;max-width:980px;margin:16px auto;border:1px solid rgba(255,255,255,.08);border-radius:12px;background:rgba(0,0,0,.28);text-align:center">
      <h2 style="margin:0 0 8px;">Want a custom build?</h2>
      <p style="opacity:.85;margin:0 0 10px">We’ll design, assemble, stress-test, and ship your perfect PC.</p>
      <a class="btn" href="custom.html">Start my custom build</a>
    </div>
  </div>

  <!-- Modal -->
  <div class="modal" id="pcModal" aria-hidden="true">
    <div class="modal-card" role="dialog" aria-modal="true" aria-labelledby="pcTitle">
      <img id="pcImg" class="modal-media" alt="PC build preview">
      <div class="modal-body">
        <div class="row" style="justify-content:space-between;align-items:center;margin-bottom:8px;">
          <h2 id="pcTitle" style="margin:0"></h2>
          <div id="pcPrice" class="price"></div>
        </div>
        <div id="pcTag" class="tag" style="margin:-6px 0 10px;"></div>

        <div class="specs" id="pcSpecs"></div>
        <div id="pcDesc" style="margin-top:10px;"></div>

        <!-- Illustrative FPS table -->
        <div class="fps" id="pcFps" style="display:none; margin-top:12px;">
          <table>
            <thead>
              <tr><th>Game</th><th>1080p</th><th>1440p</th><th>4K</th></tr>
            </thead>
            <tbody id="pcFpsBody"></tbody>
          </table>
          <div style="font-size:12px; opacity:.75; padding:8px 10px;">
            FPS values are illustrative estimates for typical settings. Actual performance varies by title and configuration.
          </div>
        </div>

        <div class="row" style="gap:10px;margin-top:12px;">
          <button class="btn" id="pcAddBtn">Add to cart</button>
          <a class="btn secondary" id="pcCustomizeBtn" href="custom.html">Customize this build</a>
          <button class="btn secondary" id="pcCloseBtn">Close</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    /* ===== Data ===== */
    const AMD_BUILDS = [
      { id:'amd-4k', title:'4K Gaming PC (AMD)', use:'Gaming', tag:'4K Gaming', price:2599, img:'https://images.pexels.com/photos/7915355/pexels-photo-7915355.jpeg?auto=compress&cs=tinysrgb&w=1600',
        desc:'Tuned for high-refresh 4K with frame generation and upscaling. Quiet fan curves, excellent temps.',
        specs:[['CPU','Ryzen 7 7800X3D'],['GPU','GeForce RTX 5080'],['RAM','32GB DDR5-6000'],['Storage','2TB NVMe Gen4'],['Cooling','360mm AIO'],['PSU','850W Gold'],['Case','Airflow chassis']],
        badge:'Popular', featured:true, order:2,
        fps:{ 'Cyberpunk 2077':[160,120,75], 'Fortnite':[300,240,140], 'Valorant':[450,380,210] } },
      { id:'amd-over', title:'Overkill PC (AMD)', use:'Gaming', tag:'Extreme', price:4499, img:'https://images.pexels.com/photos/5553050/pexels-photo-5553050.jpeg?auto=compress&cs=tinysrgb&w=1600',
        desc:'Built for everything maxed: 4K ray tracing, heavy editing, and AI. Top-tier thermals and acoustics.',
        specs:[['CPU','Ryzen 9 7950X'],['GPU','GeForce RTX 5090'],['RAM','64GB DDR5-6000'],['Storage','2TB + 4TB NVMe'],['Cooling','360mm AIO'],['PSU','1000W Gold'],['Case','Premium airflow']],
        badge:'New', featured:true, order:1,
        fps:{ 'Cyberpunk 2077':[200,160,100], 'Fortnite':[360,300,180], 'Valorant':[520,450,260] } },
      { id:'amd-creator', title:'Creator Pro (AMD)', use:'Creator', tag:'Creator', price:2999, img:'https://images.pexels.com/photos/5777692/pexels-photo-5777692.jpeg?auto=compress&cs=tinysrgb&w=1600',
        desc:'Designed for Adobe/Resolve/Blender with fast cache disks and studio driver stability.',
        specs:[['CPU','Ryzen 9 7950X'],['GPU','GeForce RTX 5080'],['RAM','64GB DDR5-6000'],['Storage','2TB 990 PRO'],['Cooling','360mm AIO'],['Scratch','Separate cache/scratch']],
        fps:null },
      { id:'amd-budget', title:'Budget Gaming (AMD)', use:'Value', tag:'Best Value', price:899, img:'https://images.pexels.com/photos/1148820/pexels-photo-1148820.jpeg?auto=compress&cs=tinysrgb&w=1600',
        desc:'1080p high settings in modern titles with an easy upgrade path.',
        specs:[['CPU','Ryzen 5 5600'],['GPU','GeForce RTX 4060'],['RAM','16GB DDR4'],['Storage','1TB NVMe'],['Cooling','Tower Air'],['PSU','650W Bronze']],
        fps:{ 'Fortnite':[220,170,90], 'Valorant':[380,300,160] } },
      { id:'amd-creator-budget', title:'Budget Creator (AMD)', use:'Creator', tag:'Creator', price:699, img:'https://images.pexels.com/photos/97077/pexels-photo-97077.jpeg?auto=compress&cs=tinysrgb&w=1600',
        desc:'Great starter for light editing and content creation with GPU acceleration.',
        specs:[['CPU','Ryzen 5 5600G'],['GPU','GeForce RTX 3050'],['RAM','16GB DDR4'],['Storage','512GB NVMe']],
        fps:null },
      { id:'amd-esports', title:'Esports Pro (AMD)', use:'Esports', tag:'Esports', price:999, img:'https://images.pexels.com/photos/8166086/pexels-photo-8166086.jpeg?auto=compress&cs=tinysrgb&w=1600',
        desc:'Tuned for esports titles with low input lag and consistent high FPS.',
        specs:[['CPU','Ryzen 5 7600'],['GPU','GeForce RTX 4060'],['RAM','16GB DDR5'],['Storage','1TB NVMe']],
        fps:{ 'Fortnite':[260,210,120], 'Valorant':[420,350,190] } }
    ];

    const INTEL_BUILDS = [
      { id:'intel-4k', title:'4K Gaming PC (Intel)', use:'Gaming', tag:'4K Gaming', price:2699, img:'https://images.pexels.com/photos/3861956/pexels-photo-3861956.jpeg?auto=compress&cs=tinysrgb&w=1600',
        desc:'Fantastic 4K gaming with frame generation, tuned for low noise and strong boost clocks.',
        specs:[['CPU','Core i7-14700K'],['GPU','GeForce RTX 5080'],['RAM','32GB DDR5-6000'],['Storage','2TB NVMe'],['Cooling','360mm AIO'],['PSU','850W Gold']],
        badge:'Popular', featured:true, order:2,
        fps:{ 'Cyberpunk 2077':[165,125,78], 'Fortnite':[310,250,145], 'Valorant':[460,390,215] } },
      { id:'intel-over', title:'Overkill PC (Intel)', use:'Gaming', tag:'Extreme', price:4599, img:'https://images.pexels.com/photos/907173/pexels-photo-907173.jpeg?auto=compress&cs=tinysrgb&w=1600',
        desc:'For the “everything on ultra” crowd. Also crushes editing and multi-task workloads.',
        specs:[['CPU','Core i9-14900K'],['GPU','GeForce RTX 5090'],['RAM','64GB DDR5-6000'],['Storage','2TB + 4TB NVMe'],['Cooling','360mm AIO'],['PSU','1000W Gold']],
        badge:'New', featured:true, order:1,
        fps:{ 'Cyberpunk 2077':[205,165,102], 'Fortnite':[370,305,185], 'Valorant':[530,460,265] } },
      { id:'intel-creator', title:'Creator Pro (Intel)', use:'Creator', tag:'Creator', price:3099, img:'https://images.pexels.com/photos/218863/pexels-photo-218863.jpeg?auto=compress&cs=tinysrgb&w=1600',
        desc:'Optimized for Adobe/Resolve with tuned scratch disks and studio-ready drivers.',
        specs:[['CPU','Core i9-14900K'],['GPU','GeForce RTX 5080'],['RAM','64GB DDR5-6000'],['Storage','2TB 990 PRO']],
        fps:null },
      { id:'intel-budget', title:'Budget Gaming (Intel)', use:'Value', tag:'Best Value', price:929, img:'https://images.pexels.com/photos/538062/pexels-photo-538062.jpeg?auto=compress&cs=tinysrgb&w=1600',
        desc:'Solid 1080p experience with an easy path to 1440p via future GPU upgrade.',
        specs:[['CPU','Core i5-12400F'],['GPU','GeForce RTX 4060'],['RAM','16GB DDR4'],['Storage','1TB NVMe']],
        fps:{ 'Fortnite':[225,175,95], 'Valorant':[390,310,165] } },
      { id:'intel-creator-budget', title:'Budget Creator (Intel)', use:'Creator', tag:'Creator', price:719, img:'https://images.pexels.com/photos/1144176/pexels-photo-1144176.jpeg?auto=compress&cs=tinysrgb&w=1600',
        desc:'Entry creative rig for photo/light video with room to grow.',
        specs:[['CPU','Core i5-13400F'],['GPU','GeForce RTX 3050'],['RAM','16GB DDR4'],['Storage','512GB NVMe']],
        fps:null },
      { id:'intel-esports', title:'Esports Pro (Intel)', use:'Esports', tag:'Esports', price:1049, img:'https://images.pexels.com/photos/1800205/pexels-photo-1800205.jpeg?auto=compress&cs=tinysrgb&w=1600',
        desc:'High-FPS esports tuning with consistent frame times and quiet acoustics.',
        specs:[['CPU','Core i5-14500'],['GPU','GeForce RTX 4060'],['RAM','16GB DDR5'],['Storage','1TB NVMe']],
        fps:{ 'Fortnite':[265,215,122], 'Valorant':[425,355,195] } }
    ];

    /* ===== State ===== */
    let BRAND = 'amd';       // 'amd' or 'intel'
    let FILTER_USE = 'all';  // 'all' | 'Gaming' | 'Creator' | 'Esports' | 'Value'
    let FILTER_PRICE = 'all';// 'all' | 'min-max'
    let SORT = 'popular';    // 'popular' | 'price-asc' | 'price-desc' | 'newest'

    /* ===== Rendering ===== */
    function getData(){
      return BRAND === 'amd' ? AMD_BUILDS.slice() : INTEL_BUILDS.slice();
    }

    function applyFilters(arr){
      if (FILTER_USE !== 'all') {
        arr = arr.filter(b => b.use === FILTER_USE || (FILTER_USE==='Value' && b.tag.includes('Value')));
      }
      if (FILTER_PRICE !== 'all') {
        const [min,max] = FILTER_PRICE.split('-').map(Number);
        arr = arr.filter(b => b.price >= min && b.price <= max);
      }
      return arr;
    }

    function applySort(arr){
      if (SORT === 'price-asc') arr.sort((a,b)=>a.price-b.price);
      else if (SORT === 'price-desc') arr.sort((a,b)=>b.price-a.price);
      else if (SORT === 'newest') arr.sort((a,b)=>(a.order||99)-(b.order||99));
      else if (SORT === 'popular') arr.sort((a,b)=>(a.badge==='Popular'? -1:1));
      return arr;
    }

    function renderFeatured(){
      const root = document.getElementById('featured');
      root.innerHTML = '';
      const base = getData().filter(b => b.featured);
      const filtered = applyFilters(base);
      const sorted = applySort(filtered).slice(0,2); // up to two featured
      if (!sorted.length) { root.style.display = 'none'; return; }
      root.style.display = 'grid';

      sorted.forEach((b,i)=>{
        const wrap = document.createElement('div');
        wrap.className = 'featured-card';
        wrap.style.flexDirection = i===0 ? 'row' : 'row';
        const img = document.createElement('img'); img.src = b.img; img.alt = b.title; img.onclick = ()=>openModal(b);
        const body = document.createElement('div'); body.className='featured-body';
        body.innerHTML = `
          <div class="tag">${b.tag}</div>
          <h2 style="margin:0">${b.title}</h2>
          <div style="opacity:.85">${b.desc}</div>
          <div class="row" style="justify-content:space-between;align-items:center;">
            <div class="price">$${b.price.toLocaleString()}</div>
            ${b.badge ? `<div class="badge">${b.badge}</div>`: '' }
          </div>
          <div class="featured-cta">
            <button class="btn" onclick="addToCart('${b.title.replace(/'/g,"\\'")}', ${b.price})">Add to cart</button>
            <button class="btn secondary" onclick="openModalById('${b.id}')">More details</button>
          </div>`;
        wrap.appendChild(img); wrap.appendChild(body);
        root.appendChild(wrap);
      });
    }

    function renderGrid(){
      const root = document.getElementById('grid');
      root.innerHTML = '';
      const data = applySort(applyFilters(getData().filter(b=>!b.featured)));
      data.forEach(b=>{
        const card = document.createElement('div'); card.className='card-pc';
        if (b.badge) { const bd = document.createElement('div'); bd.className='badge'; bd.textContent=b.badge; card.appendChild(bd); }
        const img = document.createElement('img'); img.src=b.img; img.alt=b.title; img.addEventListener('click', ()=>openModal(b));
        const quick = document.createElement('div'); quick.className='quick';
        quick.innerHTML = `<small>${b.specs.slice(0,3).map(([k,v])=>`${k}: ${v}`).join(' • ')}</small>`;
        const ctn = document.createElement('div'); ctn.className='content';
        ctn.innerHTML = `
          <div class="tag">${b.tag}</div>
          <h3 style="margin:4px 0 6px">${b.title}</h3>
          <div class="row" style="justify-content:space-between;align-items:center;">
            <div class="price">$${b.price.toLocaleString()}</div>
            <button class="btn" onclick="addToCart('${b.title.replace(/'/g,"\\'")}', ${b.price})">Add</button>
          </div>
          <div style="opacity:.8;font-size:12px;margin-top:6px;cursor:pointer" onclick="openModalById('${b.id}')">More details</div>`;
        card.appendChild(img); card.appendChild(quick); card.appendChild(ctn);
        root.appendChild(card);
      });
    }

    function setBrand(b){
      BRAND = b;
      document.getElementById('btn-amd')?.classList.toggle('active', BRAND==='amd');
      document.getElementById('btn-intel')?.classList.toggle('active', BRAND==='intel');
      renderFeatured(); renderGrid();
    }

    // Filters
    document.getElementById('filterUse').addEventListener('change', e=>{ FILTER_USE = e.target.value; renderFeatured(); renderGrid(); });
    document.getElementById('filterPrice').addEventListener('change', e=>{ FILTER_PRICE = e.target.value; renderFeatured(); renderGrid(); });
    document.getElementById('sort').addEventListener('change', e=>{ SORT = e.target.value; renderFeatured(); renderGrid(); });

    /* ===== Modal ===== */
    const modal = document.getElementById('pcModal');
    const mImg  = document.getElementById('pcImg');
    const mTitle= document.getElementById('pcTitle');
    const mPrice= document.getElementById('pcPrice');
    const mTag  = document.getElementById('pcTag');
    const mSpecs= document.getElementById('pcSpecs');
    const mDesc = document.getElementById('pcDesc');
    const mFps  = document.getElementById('pcFps');
    const mFpsBody = document.getElementById('pcFpsBody');
    const mClose= document.getElementById('pcCloseBtn');
    const mAdd  = document.getElementById('pcAddBtn');
    const mCustomize = document.getElementById('pcCustomizeBtn');
    let currentBuild = null;

    function allBuilds(){ return [...AMD_BUILDS, ...INTEL_BUILDS]; }
    function openModalById(id){ const b = allBuilds().find(x=>x.id===id); if(b) openModal(b); }

    function openModal(b){
      currentBuild = b;
      mImg.src = b.img; mTitle.textContent = b.title;
      mPrice.textContent = '$' + b.price.toLocaleString();
      mTag.textContent = `${b.tag} • ${b.use}`;
      mSpecs.innerHTML = b.specs.map(([k,v])=>`<div class="spec"><strong>${k}:</strong> ${v}</div>`).join('');
      mDesc.textContent = b.desc || '';
      if (b.fps) {
        mFps.style.display = 'block';
        mFpsBody.innerHTML = Object.entries(b.fps).map(([game,[f1080,f1440,f4k]]) =>
          `<tr><td>${game}</td><td>${f1080}</td><td>${f1440}</td><td>${f4k ?? '—'}</td></tr>`
        ).join('');
      } else {
        mFps.style.display = 'none';
        mFpsBody.innerHTML = '';
      }
      mCustomize.href = 'custom.html#customPCForm';
      modal.classList.add('open'); modal.setAttribute('aria-hidden','false');
    }
    function closeModal(){ modal.classList.remove('open'); modal.setAttribute('aria-hidden','true'); currentBuild=null; }
    mClose.addEventListener('click', closeModal);
    modal.addEventListener('click', (e)=>{ if(e.target===modal) closeModal(); });
    document.addEventListener('keydown', (e)=>{ if(e.key==='Escape' && modal.classList.contains('open')) closeModal(); });
    mAdd.addEventListener('click', ()=>{ if(currentBuild){ addToCart(currentBuild.title, currentBuild.price); closeModal(); } });

    /* ===== Cart helpers (qty-aware, cloud if logged in) ===== */
    async function waitAuthReady(ms=4000){
      try { await Promise.race([ (window.__authReady ?? Promise.resolve()), new Promise((_,rej)=>setTimeout(()=>rej(new Error('auth-timeout')), ms)) ]); } catch {}
    }
    function localAdd(item){
      const cart = JSON.parse(localStorage.getItem('cart')||'[]');
      const key = `${item.name}::${item.price}`;
      const map = new Map();
      for (const it of cart){ const k = `${it.name}::${Number(it.price)}`; map.set(k,(map.get(k)||0)+Number(it.qty||1)); }
      map.set(key,(map.get(key)||0)+1);
      const out=[]; for (const [k,q] of map.entries()){ const [n,p]=k.split('::'); out.push({name:n,price:Number(p),qty:q}); }
      localStorage.setItem('cart', JSON.stringify(out)); return out;
    }
    async function syncLocalToCloud(){
      if (!(window.isLoggedIn && window.currentUser && window.__cartAPI)) return false;
      try{
        const { getCloudCart, setCloudCart, mergeCarts } = window.__cartAPI;
        const uid = window.currentUser.uid;
        const local = JSON.parse(localStorage.getItem('cart')||'[]');
        if(!local.length) return true;
        const cloud = await getCloudCart(uid);
        const merged = mergeCarts(cloud, local);
        await setCloudCart(uid, merged);
        localStorage.removeItem('cart'); return true;
      }catch(e){ console.warn('[cart] sync local->cloud failed:', e); return false; }
    }
    async function addToCart(name, price){
      const item = { name, price, qty:1 };
      await waitAuthReady();
      if (window.isLoggedIn && window.currentUser && window.__cartAPI){
        try{
          const { addItemToCloud } = window.__cartAPI;
          await addItemToCloud(window.currentUser.uid, item);
          alert(`${name} added to your account cart!`); return;
        }catch(e){ console.warn('[cart] cloud add failed, fallback to local', e); }
      }
      localAdd(item);
      const synced = await syncLocalToCloud();
      alert(name + (synced ? ' added to your account cart!' : ' added locally (offline).'));
    }

    /* ===== Init ===== */
    setBrand('amd'); // default view
  </script>

  <script type="module" src="nav-auth.js"></script>
</body>
</html>

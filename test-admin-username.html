<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Username Validation Test</title>
  <style>
    :root{
      --space:10px; --space-sm:6px; --space-lg:16px;
      --bg:#0a0f1a; --ink:#e9eefc; --muted:#aeb9d4;
      --panel:#111729; --panel2:#0d1426; --border:rgba(255,255,255,.08);
      --accent1:#7db2ff; --accent2:#7cf2e6;
      --radius:18px; --shadow:0 20px 40px rgba(0,0,0,.35);
      --max:1200px;
    }
    body {
      font-family: system-ui;
      margin: 0;
      padding: 20px;
      background: radial-gradient(1200px 600px at 50% -10%, #0f162b 8%, transparent 55%), linear-gradient(#081021, #0a0f1a 40%, #0a0f1a);
      color: var(--ink);
      min-height: 100vh;
    }
    .test-container {
      max-width: 600px;
      margin: 0 auto;
      background: var(--panel);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 30px;
      box-shadow: var(--shadow);
    }
    .test-section {
      margin: 20px 0;
      padding: 20px;
      background: var(--panel2);
      border: 1px solid var(--border);
      border-radius: 12px;
    }
    .test-input {
      width: 100%;
      padding: 12px;
      border: 1px solid var(--border);
      border-radius: 8px;
      background: var(--panel);
      color: var(--ink);
      margin: 10px 0;
    }
    .test-result {
      padding: 10px;
      border-radius: 6px;
      margin: 10px 0;
    }
    .success { background: rgba(124,242,230,.12); border: 1px solid rgba(124,242,230,.35); }
    .error { background: rgba(255,99,132,.12); border: 1px solid rgba(255,99,132,.35); }
    .btn {
      padding: 10px 20px;
      background: linear-gradient(90deg, var(--accent1), var(--accent2));
      color: #0b0f1a;
      border: none;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      margin: 10px 5px;
    }
  </style>
</head>
<body>
  <div class="test-container">
    <h1>🧪 Admin Username Validation Test</h1>
    <p style="color: var(--muted);">Testing if the admin username "Minty-Komodo" passes validation.</p>
    
    <div class="test-section">
      <h2>✅ Validation Fix Applied</h2>
      <p>Updated username pattern from <code>/^[a-zA-Z0-9_]+$/</code> to <code>/^[a-zA-Z0-9_-]+$/</code></p>
      <p>This now allows letters, numbers, underscores, AND hyphens.</p>
    </div>

    <div class="test-section">
      <h2>🔧 Test Username Validation</h2>
      <input type="text" id="test-username" class="test-input" placeholder="Enter username to test" value="Minty-Komodo">
      <button class="btn" onclick="testUsername()">Test Validation</button>
      <div id="validation-result"></div>
    </div>

    <div class="test-section">
      <h2>📋 Admin Credentials</h2>
      <div style="background: var(--panel); padding: 15px; border-radius: 8px; border: 1px solid var(--border);">
        <p><strong>Username:</strong> <code>Minty-Komodo</code> ✅ (now allows hyphens)</p>
        <p><strong>Password:</strong> <code>hJ.?'0PcU0).1.0.1PCimA4%oU</code></p>
        <p><strong>Email:</strong> <code>griffin@crowhurst.ws</code></p>
      </div>
    </div>

    <div class="test-section">
      <h2>🚀 Quick Actions</h2>
      <button class="btn" onclick="window.open('login.html?admin=true', '_blank')">Test Admin Login</button>
      <button class="btn" onclick="window.open('signup.html', '_blank')">Test Signup</button>
      <button class="btn" onclick="runAllTests()">Run All Tests</button>
    </div>

    <div id="test-results"></div>
  </div>

  <script src="auth-validation.js"></script>
  
  <script>
    let validator;
    
    document.addEventListener('DOMContentLoaded', function() {
      validator = new AuthValidator();
      
      // Auto-test the admin username
      setTimeout(() => {
        testUsername();
        runAllTests();
      }, 500);
    });
    
    function testUsername() {
      const input = document.getElementById('test-username');
      const result = document.getElementById('validation-result');
      const username = input.value;
      
      if (!validator) {
        result.innerHTML = '<div class="test-result error">Validator not loaded yet. Please wait...</div>';
        return;
      }
      
      const error = validator.validateUsername(username);
      
      if (error) {
        result.innerHTML = `<div class="test-result error"><strong>❌ Validation Failed:</strong> ${error}</div>`;
      } else {
        result.innerHTML = `<div class="test-result success"><strong>✅ Validation Passed:</strong> "${username}" is a valid username!</div>`;
      }
    }
    
    function runAllTests() {
      const resultsDiv = document.getElementById('test-results');
      resultsDiv.innerHTML = '<h2>🧪 Comprehensive Tests</h2>';
      
      const testCases = [
        { username: 'Minty-Komodo', expected: null, description: 'Admin username with hyphen' },
        { username: 'regular_user', expected: null, description: 'Regular username with underscore' },
        { username: 'user123', expected: null, description: 'Username with numbers' },
        { username: 'ab', expected: 'Username must be at least 3 characters', description: 'Too short username' },
        { username: 'a'.repeat(25), expected: 'Username must be less than 20 characters', description: 'Too long username' },
        { username: 'user@name', expected: 'Username can only contain letters, numbers, underscores, and hyphens', description: 'Invalid character (@)' },
        { username: 'user name', expected: 'Username can only contain letters, numbers, underscores, and hyphens', description: 'Invalid character (space)' },
        { username: '', expected: 'Username is required', description: 'Empty username' }
      ];
      
      testCases.forEach((testCase, index) => {
        const error = validator.validateUsername(testCase.username);
        const passed = error === testCase.expected;
        
        const resultClass = passed ? 'success' : 'error';
        const resultIcon = passed ? '✅' : '❌';
        
        resultsDiv.innerHTML += `
          <div class="test-result ${resultClass}">
            <strong>${resultIcon} Test ${index + 1}:</strong> ${testCase.description}<br>
            <strong>Input:</strong> "${testCase.username}"<br>
            <strong>Expected:</strong> ${testCase.expected || 'Valid'}<br>
            <strong>Actual:</strong> ${error || 'Valid'}<br>
            <strong>Result:</strong> ${passed ? 'PASS' : 'FAIL'}
          </div>
        `;
      });
      
      const passedTests = testCases.filter(testCase => {
        const error = validator.validateUsername(testCase.username);
        return error === testCase.expected;
      }).length;
      
      resultsDiv.innerHTML += `
        <div class="test-result ${passedTests === testCases.length ? 'success' : 'error'}">
          <strong>📊 Summary:</strong> ${passedTests}/${testCases.length} tests passed
        </div>
      `;
    }
  </script>
</body>
</html>